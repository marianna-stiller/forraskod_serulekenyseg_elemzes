program if commentblock isset offsetlookup variable _GET string 'id' block expressionstatement assign variable id offsetlookup variable _GET string 'id' if commentblock bin call name is_numeric variable id boolean true block try block expressionstatement commentline commentblock assign variable dbh new name PDO string 'mysql:host=localhost;dbname=sql_injection_example' string 'dbuser' string 'dbpasswd' expressionstatement commentblock call propertylookup variable dbh identifier setAttribute staticlookup name PDO identifier ATTR_ERRMODE staticlookup name PDO identifier ERRMODE_EXCEPTION expressionstatement commentblock assign variable q string \SELECT username \n                FROM users\n                WHERE id = :id\ expressionstatement commentline assign variable sth call propertylookup variable dbh identifier prepare variable q expressionstatement commentline call propertylookup variable sth identifier bindParam string ':id' variable id expressionstatement commentline call propertylookup variable sth identifier execute expressionstatement commentline call propertylookup variable sth identifier setFetchMode staticlookup name PDO identifier FETCH_ASSOC expressionstatement commentline assign variable result call propertylookup variable sth identifier fetchColumn expressionstatement commentblock print call name htmlentities variable result expressionstatement commentline assign variable dbh nullkeyword null catch block expressionstatement commentblock call name error_log bin string 'PDOException - ' call propertylookup variable e identifier getMessage number expressionstatement commentblock call name http_response_code number expressionstatement exit string 'Error establishing connection with database' name PDOException variable e block expressionstatement commentblock call name http_response_code number expressionstatement exit string 'Error processing bad or malformed request' commentblock commentblock commentline commentblock commentblock commentblock commentline commentline commentline commentline commentline commentblock commentline commentblock commentblock commentblock^
